# Улучшения Ozon Scraper

## Текущая файловая структура

```
src/
├── bot/
│   └── index.ts               # Сервис Telegram бота
├── config/
│   └── config.ts              # Файл конфигурации (не используется)
├── lib/
│   └── storage.ts             # Сервис хранения данных
├── services/
│   ├── ozon.ts                # Сервис для работы с Ozon
│   ├── product.ts             # Сервис для работы с продуктами
│   ├── scheduler.ts           # Сервис планировщика
│   └── user.ts                # Сервис для работы с пользователями
├── types/
│   └── index.ts               # Типы и интерфейсы
├── utils/
│   ├── analytics.ts           # Аналитика продуктов
│   ├── helpers.ts             # Вспомогательные функции
│   ├── logger.ts              # Логгер
│   └── report.ts              # Создание отчетов
└── index.ts                   # Основной файл приложения
```

## Предлагаемая файловая структура

```
src/
├── api/                       # API-интерфейсы для внешних сервисов
│   ├── ozon/                  # Модуль для работы с Ozon
│   │   ├── index.ts           # Основной экспорт
│   │   ├── parser.ts          # Парсер данных
│   │   └── browser.ts         # Управление браузером
│   └── telegram/              # Модуль для работы с Telegram
│       ├── index.ts           # Основной экспорт
│       ├── commands.ts        # Обработчики команд
│       └── formatter.ts       # Форматирование сообщений
├── config/
│   ├── index.ts               # Конфигурация и валидация
│   └── types.ts               # Типы конфигурации
├── domain/                    # Бизнес-логика
│   ├── products/              # Модуль продуктов
│   │   ├── index.ts           # Основной экспорт
│   │   ├── service.ts         # Сервис продуктов
│   │   └── repository.ts      # Репозиторий продуктов
│   ├── analytics/             # Модуль аналитики
│   │   ├── index.ts           # Основной экспорт
│   │   ├── service.ts         # Сервис аналитики
│   │   └── types.ts           # Типы аналитики
│   └── users/                 # Модуль пользователей
│       ├── index.ts           # Основной экспорт
│       ├── service.ts         # Сервис пользователей
│       └── repository.ts      # Репозиторий пользователей
├── infrastructure/            # Инфраструктурный код
│   ├── scheduler/             # Модуль планировщика
│   │   ├── index.ts           # Основной экспорт
│   │   └── service.ts         # Сервис планировщика
│   ├── storage/               # Модуль хранения
│   │   ├── index.ts           # Основной экспорт
│   │   └── leveldb.ts         # Реализация на LevelDB
│   └── logger/                # Модуль логирования
│       ├── index.ts           # Основной экспорт
│       └── consola.ts         # Реализация на Consola
├── utils/                     # Утилиты
│   ├── formatting.ts          # Форматирование текста
│   ├── dates.ts               # Работа с датами
│   └── browser-helpers.ts     # Вспомогательные функции для браузера
├── types/                     # Общие типы
│   └── index.ts               # Типы и интерфейсы
├── app.ts                     # Инициализация приложения
└── index.ts                   # Точка входа
```

## Основные изменения в архитектуре

1. **Разделение обязанностей**
   - Выделение доменных модулей (продукты, пользователи, аналитика)
   - Создание слоя API для внешних сервисов (Ozon, Telegram)
   - Перенос инфраструктурного кода в отдельный слой

2. **Улучшение модульности**
   - Каждый модуль имеет четкий интерфейс через index.ts
   - Логическое группирование связанных файлов
   - Более четкие зависимости между модулями

3. **Разделение репозиториев и сервисов**
   - Репозитории отвечают за доступ к данным
   - Сервисы содержат бизнес-логику
   - Легче тестировать и заменять компоненты

4. **Улучшенная инфраструктура**
   - Выделение планировщика, хранилища и логгера
   - Возможность легко заменить реализации (например, другая БД)

5. **Конфигурация и инициализация**
   - Вынесение инициализации из index.ts в app.ts
   - Централизованная валидация конфигурации

## Рекомендации по миграции

1. Сначала создать структуру папок
2. Постепенно переносить код, начиная с базовых слоев (инфраструктура, утилиты)
3. Переработать модули по одному, сохраняя работоспособность всего приложения
4. В последнюю очередь обновить точку входа и инициализацию

## Первоочередные задачи

1. Создать слой конфигурации с валидацией
2. Выделить сервис форматирования для Telegram сообщений
3. Разделить OzonService на компоненты (браузер, парсер)
4. Создать репозитории для работы с данными
